<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>What Todo?</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4c8bf5">
  <style>
    /* --- your existing CSS --- */
    /* Iâ€™ll leave this unchanged for brevity */
  </style>
</head>
<body>
  <div class="container">
    <!-- AUTH -->
    <div id="auth">
      <h1>What Todo?</h1>
      <input id="username" type="text" placeholder="Username" />
      <input id="password" type="password" placeholder="Password" />
      <button onclick="signup()">Sign Up</button>
      <button onclick="login()">Log In</button>
      <span class="switch-link" onclick="toggleMode()">Switch to Log In</span>
    </div>

    <!-- APP -->
    <div id="app">
      <h1>Your Tasks</h1>
      <form id="todoForm" onsubmit="addTodo(event)">
        <input id="todoInput" type="text" placeholder="Task name..." />
        <select id="category">
          <option value="Work">Work</option>
          <option value="Personal">Personal</option>
          <option value="Shopping">Shopping</option>
        </select>
        <select id="priority">
          <option value="Low">Low</option>
          <option value="Medium">Medium</option>
          <option value="High">High</option>
        </select>
        <input id="dueDate" type="date" />
        <button type="submit" style="grid-column: span 2;">Add Task</button>
      </form>

      <div id="filters">
        <select id="filterCategory" onchange="renderTodos()">
          <option value="">All Categories</option>
          <option>Work</option>
          <option>Personal</option>
          <option>Shopping</option>
        </select>
        <select id="filterPriority" onchange="renderTodos()">
          <option value="">All Priorities</option>
          <option>Low</option>
          <option>Medium</option>
          <option>High</option>
        </select>
        <select id="filterStatus" onchange="renderTodos()">
          <option value="">All Status</option>
          <option value="pending">Pending</option>
          <option value="done">Completed</option>
        </select>
      </div>

      <ul id="todoList"></ul>
      <button class="clear-btn" onclick="clearAll()">Clear All</button>
      <button onclick="logout()" style="background:#333;margin-top:10px;">Log Out</button>
    </div>
  </div>

  <script>
    /* --- your existing JS functions (signup, login, openApp, etc.) --- */
    let mode = 'signup';
    function toggleMode() { /* ... */ }
    function signup() { /* ... */ }
    function login() { /* ... */ }
    function openApp() { /* ... */ }
    function logout() { /* ... */ }
    function getTodos() { /* ... */ }
    function saveTodos(arr) { /* ... */ }
    function addTodo(e) { /* ... */ }
    function toggleDone(i) { /* ... */ }
    function editTask(i) { /* ... */ }
    function deleteTask(i) { /* ... */ }
    function clearAll() { /* ... */ }
    function renderTodos() { /* ... */ }

    if (localStorage.getItem('currentUser')) openApp();

    // --- SERVICE WORKER REGISTRATION ---
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/pwabuilder.sw.js')
          .then(reg => console.log('Service worker registered!', reg))
          .catch(err => console.log('SW registration failed', err));
      });
    }
  </script>
</body>
</html>
